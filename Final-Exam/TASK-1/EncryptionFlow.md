Encrypted Messaging Flow (Hybrid Encryption)

This document outlines the cryptographic flow implemented in the prototype. This system uses a Hybrid Encryption scheme, combining the efficiency of Symmetric encryption (AES) with the secure key exchange capabilities of Asymmetric encryption (RSA).

1. The Concept

RSA (Asymmetric): Slow for large data, but excellent for sharing keys securely.

AES (Symmetric): Very fast and secure for large amounts of data, but requires both parties to already have the same key.

Hybrid: We use AES to lock the message, and RSA to lock the AES key.

2. Step-by-Step Workflow

Phase 1: Key Generation (User A)

Action: User A generates a 2048-bit RSA Key Pair.

Result: * Private Key: Kept secret by User A.

Public Key: Shared with User B.

Phase 2: Encryption (User B)

User B wants to send a secret file (message.txt) to User A.

AES Key Gen: User B generates a random, one-time 32-byte session key for AES-256 and a 16-byte Initialization Vector (IV).

Message Encryption (AES): * The plain text is padded (PKCS7) to fit the block size.

The message is encrypted using the random AES Key and IV.

Output: encrypted_message.bin (Contains IV + Ciphertext).

Key Encryption (RSA):

User B takes the one-time AES key from step 1.

User B encrypts this key using User A's Public RSA Key.

Output: aes_key_encrypted.bin.

Phase 3: Transmission

User B sends two files to User A:

encrypted_message.bin (The locked data)

aes_key_encrypted.bin (The locked key to open the data)

Phase 4: Decryption (User A)

User A receives the files and performs the reverse operations.

Decrypt Key (RSA):

User A reads aes_key_encrypted.bin.

User A uses their RSA Private Key to decrypt this file.

Result: User A now possesses the raw AES session key generated by User B.

Decrypt Message (AES):

User A reads encrypted_message.bin.

User A extracts the IV and the Ciphertext.

User A uses the recovered AES Key to decrypt the ciphertext.

The data is unpadded.

Output: decrypted_message.txt.

3. Security Properties

Confidentiality: Only someone with User A's private key can retrieve the AES key, and without the AES key, the message cannot be read.

Efficiency: We only perform the computationally expensive RSA operation on a small 32-byte key, rather than the entire message body.